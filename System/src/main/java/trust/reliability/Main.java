package trust.reliability;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.text.DecimalFormat;
import java.util.*;

import scala.util.Random;

public class Main {
	static void swap(int[] arr, int a, int b) {
		int tmp = arr[a];
		arr[a] = arr[b];
		arr[b] = tmp;
	}
	
	static void quickSort(int[] arr, int left, int right) {
		int pl = left, pr = right;
		if(pl<0 || pr>=arr.length) return;
		
		int pivot = arr[(pl+pr)/2];
		
		do {
			while(arr[pl]<pivot) pl++;
			while(arr[pr]>pivot) pr--;
			if(pl<=pr) swap(arr, pl++, pr--);
		}while(pl<=pr);
		
		if(left<pr) quickSort(arr, left, pr);
		if(pl<right) quickSort(arr, pl, right);
	}
	
	static void removeNull(List<String> lst) {
		if(lst == null) return;
		
		while(lst.contains(null)) {
			lst.remove(null);
		}
	}
	
	public static int getFollCount(List<String> noms, int prev) throws Exception {
		FileInputStream fr=new FileInputStream(new File("C:/Users/PC/Downloads/twitter-2010.txt"));   //reads the file
    	BufferedReader br=new BufferedReader(new InputStreamReader(fr));  //creates a buffering character input stream
    	String[] ids;String t;int[] arr = new int[noms.size()];
    	int c = 0;
    	
    	if(prev < 5) prev = 50;
    	
    	fr.getChannel().position(0);
    	br = new BufferedReader(new InputStreamReader(fr));
    	
    	while((t=br.readLine())!=null)	{
			ids = t.split(" ");
			String master = ids[0], slave = ids[1];
			
			if((++c)%100000000 == 0) System.out.println("Finding next Candidate at line:"+c);
			
			if(c%20000000 == 0) {
				for(int i=0;i<arr.length;i++)
					if(arr[i]>=prev) {
						br.close();
						return i;
					}
			}
			
			if(noms.contains(master)) arr[noms.indexOf(master)]++;
			else if(noms.contains(slave)) arr[noms.indexOf(slave)]++;
		}

    	br.close();
    	return -1;
	}
	
	@SuppressWarnings("unchecked")
	public static void main( String... args ) throws Exception
    {
		FileInputStream fr=new FileInputStream(new File("C:/Users/PC/Downloads/twitter-2010.txt"));
    	BufferedReader br=new BufferedReader(new InputStreamReader(fr)); //creates a buffering character input stream
    	DecimalFormat formatter = new DecimalFormat("#,###");
    	fr.getChannel().position(0);br = new BufferedReader(new InputStreamReader(fr));
    	
		Queue<String> follower = new LinkedList<>();
		Queue<String> followee = new LinkedList<>();
		
		try ( Database greeter = new Database( "bolt://localhost:7687", "neo4j", "1234" ) ){
			int l = 1;int c = 0;//l for file scan cnt, c for file line cnt during scanning
			//진행한 사람들 = ['@barackobama', '@britneyspears', '@dollyparton', '@sundarpichai', '@theestallion', '@BTS_twt']
			
			//String start = Check.checkCSV("40343083", 1);//t_id -> csv_id
			String t;//t is buffer for filereader
			String[] ids;//ids for multiuser function parameter
			/*
			int max = 6800;
			greeter.insertNode(start, Check.checkCSV(start, 0));
			//★
			String start = "1108050829393707008";
			//★
			int tmp_id = 50030000;
			//★
			String orgie = "50030000";
			
			greeter.insertNode(String.valueOf(tmp_id++), start);
			//★
			int max = 16000;
			
			while(greeter.nodeCount()<=max) {
				/*
				System.out.println("Read file "+l+" times.");
				
				while((t=br.readLine())!=null)	{
					ids = t.split(" ");
					String master = ids[0], slave = ids[1];
					
					if((++c)%(int)Math.pow(10, 8)==0) System.out.println("Reading line: "+formatter.format(c));
					
					if(master.equals(start) && follower.size()<2000) follower.add(slave);
					else if(slave.equals(start) && followee.size()<20) followee.add(master);
					
					if(follower.size()>=2000 && followee.size()>=20) break;
				}c=0; l++;
				
				//★
				String[] smth = new String[]{"1413134024965558273", "1441719840272642048", "1439214918662766592", "20369461", "1429526727362060299", "1441717082467430408", "1434186315822682115", "1274865119672111107", "1137199424", "1109589604594864129", "1441712203724247044", "792655859272785920", "1441710666918752268", "1440555029740417039", "390128967", "2841141356", "1190682810228625408", "1327614776101507072", "1441693869985259526", "1441699062659514370", "1328155037344808961", "1441694123493249024", "1439574698904457226", "242947894", "1363907369231646721", "1433036644269969412", "1441685829294776322", "1441680351387025411", "1441683480690053121", "402944740", "3309524747", "1421452980180619271", "1427330934391537665", "1436262031154286592", "365339954", "1441681290227433473", "1437048544964186114", "1441675629137596416", "1441675001598398471", "1441666524142456840", "1092915384779304960", "1441353958228852737", "1441642793395392515", "1441664774366908419", "1411522535888351237", "921739251104059393", "1441552365195182080", "1299470824471228417", "1431250959787831310", "1212294118325383168", "1441669065618038788", "1086254426992578560", "1441665683415203844", "738583681669828608", "1417172131452887131", "1441663547994300421", "1441582592164204547", "1441665027748941825", "1428938827163488257", "1441663826034769923", "1377614279881457667", "1441659063973019654", "1441242013899255818", "1441657457558781953", "1131951961673281543", "1441655714942885891", "1441656336329043971", "1441652888539856903", "1441651411259854852", "1441655244962758657", "1441651139552763907", "1329170693817331722", "1441649668815929345", "1163768746000965633", "1441647444685557761", "1441647849633042437", "1441644672149909517", "1441643264633815043", "1441644279340810242", "1441642630975082498", "1441641684320731145", "1441640441447809025", "1441642006338424836", "378210019", "907272908078170113", "1441203114317516803", "1441636325489213445", "1438384675685208070", "1441637225855275012", "1441636193934864387", "2585764402", "1441635028660736002", "1437899763320430592", "1441635657571438593", "1310693869", "1416263246898733059", "1439451046468886529", "1441631630196572162", "1441622694387064841", "19103563", "1276311256576786433", "426097668", "1441015736663789568", "900367105823981571", "1334347995324719104", "1154164782578065408", "2621931814", "1433396310883725313", "1203318337951936513", "1441626404437692416", "1441623196512313345", "1441622850641616900", "183859230", "1441622961824305155", "1436590152655138820", "1441621658788270081", "1441621029114155015", "259930613", "1441602407150993413", "1441620442955976705", "1440522341595766794", "1441616341291569155", "1441616196906876932", "1441614371256369157", "633437055", "1441611345409966091", "1441609938531336192", "1441615539533594629", "1441614961692741639", "1441614245511122944", "1441614488550076423", "1441614015168278531", "1441613332004311045", "1441611374119899139", "1441510842718117890", "1441611655352184840", "1441604421184458760", "1441608749911719947", "1441611185535655939", "1435594715441901574", "1440735778527592450", "830493263106818048", "1422044320409034752", "1441598299601965059", "1441609688781525006", "1364130082026004481", "430265085", "1441605955712544771", "1441608692755931146", "1311114475576217600", "1441559877323661314", "1344874917452341249", "1441601371157897217", "1441608415910903827", "1441585471318990854", "1424915800176173060", "1441606033705603073", "959631893284110336", "1434001914098864128", "1081620347529482240", "1441601617455828996", "18775457", "308631605", "1441603680180981760", "1303131553107767296", "1441604365995835403", "346248051", "1441383066006601734", "1395237887050874880", "1441601060531957763", "992215014617571328", "1426520263106170882", "1441599406566875140", "1396887251217391616", "1441599516868689923", "1427612581380960262", "1441594978799472648", "1441583550868836359", "2997139013", "1441597861708255236", "1090431298861219840", "1441596758174273540", "1441596534705975296", "1441596250218921985", "1208217215582949377", "1441596349720326148", "1441593053001633795", "1441594103989370882", "1441591168484012036", "1222234030755713028", "451485396", "1441594094719946755", "1441591624060977157", "1441215749356277773", "4777000217", "1441588003508396032", "1364161529478737924", "1441590997176119300", "1441590791730712580", "1441590690333356035", "796571090", "1441590990523887619", "1391219317967048704", "1441580472962732036", "1347202415662161921", "1441588541440417793", "1441586798124154881", "1441584544121905155", "1441588333331714048", "1441587942716178432", "1437220453995593731", "1441586233658855424", "1250959795038949376", "1441587661269966855", "1441586661138206723", "1441585692409094147", "1441578891672383490", "163689635", "757851971290144768", "941849966", "1441579280941518859", "1441582355043393546", "1441579083561721867", "1417420021513342979", "1430551442738266119", "323561373", "1441580742136373252", "1418659759373242369", "1441580516902248455", "1438566333977960458", "1441578815914868736", "2248376174", "1441577270812971009", "1441416628500000770", "1440704370916528136", "949366141738192896", "83530063", "1441570234188525570", "1017561177461874688", "1441574121251356679", "1441559688751968259", "1441574648957730818", "1441574885382254597", "1436659077069918216", "1441569805312561164", "1578827394", "1441572637302419464", "1441572265200537601", "2153729675", "1441571682309718019", "1441571956441042945", "4499569588", "1441567528447217674", "1336506641315926018", "342450891", "46416464", "1436193436000874521", "1441567613616734208", "1441569596742377475", "1435111213273268227", "1218303119148236800", "1441548251082072065", "1440837066238017541", "1441568541560348672", "1441568359569518595", "1441216877305352203", "1154367347328729088", "1121515868918181888", "1364544527973945344", "1441566130481426459", "1441565352891064327", "1441564536360747009", "1441565548274356224", "1334165394", "1441565499242868737", "1430871941368397829", "343173698", "1188236287372857344", "1136770176110747650", "318704475", "1441562988482216049", "1320441251540488196", "40175050", "1020662683", "1317282988011311104", "1428577469926313988", "1420162179412762628", "1440007040018133002", "1441552492274151430", "1441560932706971659", "297755085", "1441556213905301511", "354606708", "1350217874636492802", "435017751", "1441557161323098113", "1441558505454850048", "1441557089080336385", "1441556814152155137", "1441553566804578308", "1441554861116461061", "1441556992380653575", "1441555848082321413", "1441557071481098246", "1438813448159248384", "1441555818864730112", "1441553673516032004", "1441550634851790850", "1441553783557816321", "1441554605083541512", "1441555419374047233", "1432491208773881857", "704342027", "1441528502386368513", "1441550129828294663", "1441553740796887046", "1441552770734034950", "1441550926326628352", "1432567442807697410", "1441551274852319232", "1441551891855384579", "1415038018814156801", "508280797", "1441549607826120704", "1437499313031110660", "1441551113468006408", "1441550132642660353", "50180126", "1441547066174443525", "1441549061895507970", "2279754915", "857449453", "1349156568688779266", "1441546432679276550", "2474135532", "1441167133027692553", "820379037201666049", "1441547009341550598", "1441545377132417026", "1441546226885746688", "1441542970075856906", "1441537852186058757", "735565885", "1435399110815739906", "1441543754435813379", "44677687", "1441544561419976705", "2616352418", "1441543320375738369", "1440380955466686465", "1103930286", "852314756799004672", "234201107", "1432768733794095108", "1441537737107009538", "1417967713822064648", "1441536807867326464", "1429132631527104522", "1441291713851449353", "546306158", "1441535121077723143", "1441534162784059397", "1441535188421447680", "1434516414233300994", "1441530675165683724", "1441525104672792579", "1441426959729246209", "1441529595417726978", "1441522129975926786", "1441529790767382534", "279914551", "1441529553298628608", "1441527142689423368", "52491445", "1437236507626991617", "1441365762006994944", "1441525317953224705", "1441528317488807937", "1348792244191506432", "1440294678474096646", "1441525335724421123", "1441526210270359555", "1437715972316618752", "1441523588063023104", "1441525325519679490", "1441522529294815235", "1424275389971681282", "1274890833339318278", "876862632", "1441524904478846977", "1441489831167610880", "1441366182242635782", "1441522659959918592", "1131909782401626113", "1441524822807302144", "905613763126091776", "1439336991020261380", "2715731978", "1441521167710371845", "1441522386659012611", "1441518354515173377", "1441521069148491780", "1441522288147398657", "1441520283073097728", "1355031528410144769", "1414691161336336390", "2765526854", "1432698373459562503", "1441520062376988672", "18648304", "1441515222422884358", "1441516007982571520", "1441519225198231557", "1058447431", "1441518580110016519", "2569944346", "1441518384265453570", "1441517490752798723", "1441514317011107842", "1441514549908287489", "1313854071451774976", "1441516076802654212", "1441505851672567811", "1441513490850537475", "1362889192951353346", "1419409405808939008", "1441513530365124613", "1435197912737202184", "888841465", "1441511413990649856", "2312501840", "1356167181474516993", "1441511464322404352", "1275977397742047238", "1441509681684307969", "1432691169386016770", "1441509529368203265", "938170908052570112", "1414315259637207044", "1368648527971311618", "3014257194", "1359534465039683588", "1441504849779122176", "419174496", "1361335128912519174", "1441505328755924995", "1441504235695362048", "1441498123256295424", "1441498624224022529", "1441501759415865348", "1441501432973246465", "1441501422009286667", "1400062846524928004", "1440086424661889028", "2949649473", "1441499409838186496", "1441499160189014016", "888747860862304256", "1441501371040079876", "1441499534723633153", "1441498998980808704", "1184587434", "1441499141406920709", "1440840291527790593", "1390794103831425025", "1441497628521349125", "1441496907810054151", "1441496585947463681", "906902379991371777", "1441493768675471367", "1441494120158187521", "1441493071561175042", "179496024", "1436011646753939463", "1441490618744672263", "1441490386015297537", "1275045304463757312", "1391917502448472073", "1440100210097721350", "1441489125056647168", "1329172847244189696", "1441489056324407296", "1414629065160597504", "1370409507285823488", "1441488574210199552", "1441488761196462087", "2213316294", "1368020980375904256", "1441487280976195585", "2344138662", "1441486452387319808", "1441486623762305026", "1441486905896366084", "1328464365700440071", "1441484790667042819", "1441484446213947401", "1441483053713420296", "1441479848040435712", "1441482599449329664", "1441480253134753794", "1373481714199240705", "399477091", "1440805113770045442", "1441479652753633282", "1404897336594153479", "1425952619642687496", "1441478501463470080", "1441478369258868747", "1437259026845294592", "1441476464566624262", "1412514640664399873", "1213997401091952640", "700702152528777216", "1413632866471145473", "1441473103792574467", "1440713626172616713", "1441463800452947974", "1441473148671696896", "1435681745987203074", "1356231730458316801", "1429521376092753924", "1440161346738266112", "873030187", "454139983", "1431595598285873152", "1441217439144894466", "1319901908740485121", "1441469185154949120", "1439731369135980545", "1441468404485943296", "1441466040735580161", "1210119494", "1441462437002113027", "1441465637285470210", "1361485843937038343", "1441464357007790082", "1441464813146738691", "1441456816047616007", "3375050675", "1441368585192947719", "1441457000605384711", "113921071", "1441461404444160019", "1441112353295060995", "1252678495488151554", "1441455510083932166", "2872081447", "1441460390030942209", "1407895513957945345", "1349150352684306435", "1441459440402698242", "1335369762893774849", "1079819844915208193", "1441147263355551745", "1441397382348873731", "300414974", "1089197398574882816", "1439849631735685120", "1388324851992125443", "1438824615506235399", "1441455604158062592", "1434672762547838976", "397625919", "193888920", "1441455390558879750", "1014298680059486209", "1441452663359606789", "1441454819194015746", "1383645477258686473", "1441454475814719492", "1441451176940163073", "1441453812586221569", "1324038445656875010", "1438549214104014859", "1441450409265086470", "1418647555836047364", "1087138670", "1441065148509085698", "1441452055453966341", "1441451738075172864", "1441451868845117440", "1441445327559610368", "1441114516381528067", "1441450546754244609", "1441250865617072129", "1441450901160566786", "27761199", "1441449225485787136", "1441444511369007109", "1441446215741100034", "1441444658177986563", "1441435942565433346", "830593167342702593", "1441447431103647745", "1172274321223487488", "1441447232356618247", "1210688429941575686", "1419948219279290370", "1592168814", "1440287008287461382", "1441444595661873159", "1441435735593156614", "1441438418827759617", "1441441240160129028", "1441443509328912386", "1194329560390807552", "1441442523759538189", "1430008381780242438", "1441418183659986946", "1441438233858953225", "1441440499739492357", "1441439118853087233", "1116476063637483525", "1192136969880580096", "1325900190813970433", "1348930091011756032", "1441437073601302529", "1423639736816652289", "1068571857299763200", "1441437533548662787", "1441436228033912836", "1441437158208770054", "1422385268846481409", "1164635306", "582186287", "940396842935836672", "1441414553338777600", "1434031203158528002", "1441433585366573057", "277076057", "973281127585779715", "1121490971798065152", "1441431595345350664", "1441426450486337538", "1441378451886280704", "1441431218927636481", "1441429108341317635", "1257864220625993729", "1435694927611039750", "1047136941114892289", "1441426177072132101", "1441424041936449547", "1441426680799707138", "1407328348016099329", "1441423329387335689", "1441422835050713097", "1441425454322356225", "1441424063889608707", "3469832654", "1441424375895441408", "1441423117444960256", "507525661", "1441422356145049611", "1441368495262863360", "175205635", "1441420395198906374", "1226945343083950088", "1437394824093650945", "1441419741080408067", "1441417268265566210", "1441416775384506371", "488131563", "543741191", "1441070516643799051", "1441420089174102031", "1441418620051943426", "1430036067512725519", "1386088315028492288", "1441419317518618631", "1441418548266639361", "1441417178574725122", "3331038226", "206662079", "1441412134957686787", "1429101690188406788", "1441413642361126912", "1440101146878783490", "1441403366924455952", "2932884604", "1431464298761621505", "1441412852103843845", "1441411628919103488", "2840751631", "1160208032409649153", "1441406139699109888", "1331295170281803787", "1328169385219874817", "1441412034747191296", "2575650531", "1441410256081391619", "2617976461", "1427108995806924802", "776789911", "1433378524430229504", "174418380", "1384619226871177216", "1441404295342026760", "1252295946328698880", "3001249348", "1441399882313449480", "1154339638821232641", "404588806", "1414772917368459268", "1441400333037568009", "1441405205459832846", "1441402198953320449", "1391048268579287044", "1441402602156019723", "1441400294479335438", "1441402175071002638", "1198444059037229057", "1441403092579225605", "1362279957779472386", "25621594", "789331489074708480", "1441223051266252803", "1439351228706836483", "1439968356124270594", "1440127043753103361", "1441390820381265926", "367279759", "1441397466205655040", "1440158354731528193", "1421161751647645698", "1441393263160659973", "1441396703454662664", "2350922516", "1229271590690533376", "1441396596587974668", "2201387695", "1441396178306752514", "805293763", "1412134131413225474", "903657708586360832", "1441395449349484546", "1441395412758405120", "1441393254289661953", "1441390419380776960", "1441392702361374720", "1441393687934627847", "24319819", "1441392437390282752", "1433062726419505161", "1440471004589932554", "1441383006724231174", "1412141828917366784", "1441392809341120526", "1441392616457658374", "1440812178198581248", "1441391335705964545", "1432756529019641857", "1440347379119448076", "316614539", "1441017802073194499", "349958505", "1347377201650561026", "1441389014590922756", "1441061777480036355", "1436095404110716930", "2592124157", "1441381725829926912", "1441387215284682761", "978809864611880960", "1426377298127753219", "1134048895493951490", "1441384942626230282", "1441015903295000578", "1441385230930100237", "1441383442831364096", "44461005", "113369155", "1381710965620813827", "1440620387314790415", "1440655093464920068", "1441382968040181771", "1436687338931949572", "1039657637082742785", "1441380717326319628", "1436179757171871744", "1441380632668479499", "1305246019903463425", "2295487524", "1441379285575499781", "1441378623332704256", "1439707256468111362", "1344736759117176832", "1441372453557583883", "1025033881521713152", "1433251540106715138", "439591491", "1441375483166281729", "1441375042214850565", "1359040001372131329", "1360092205365477377", "1441367727973797888", "1441372692867809283", "4728261863", "1441227140494610439", "929154678", "1441370656633937920", "1441369542366748673", "19069797", "1441370833973243905", "1441369813188710407", "152401794", "1441367279900446720", "1371547676127420420", "1518067166", "1441367043769442307", "1441365610936553472", "1435765022639206400", "1441365585737105415", "1441366105319108623", "1441366021164523536", "1436472570019127298", "1423107438526533633", "1427629433742057484", "1220561102255329281", "2291990834", "1441360525057683467", "1295635847270805505", "1430169857547509760", "1439599836144168961", "1441359940589740044", "1441350643151618051", "1441358838964244481", "29772723", "2793673757", "1082314832848867329", "1441353727156183046", "1438538075718787073", "1441354133035012096", "1441289647481507850", "81144758", "1441350710566608900", "1436669028915896324", "1441204531837083653", "1356315370848735234", "1441347870351712270", "146631749", "1213522342770442240", "1441345947515043844", "1441341024643665929", "1441220264465866755", "1441347453781897227", "1441346432229785615", "1441075460121759749", "1441341362276687874", "1433032248371126283", "1441339612039766019", "2949569747", "1338568239492763648", "1422338540000751619", "1354988877346463748", "2762521947", "1441336935780282374", "1441336664010334214", "1441333197019648003", "1441332064821776390", "1423627724602675201", "1441328118736703492", "1440566280625393668", "1441321713375989764", "2235192577", "1441321006337978377", "64031992", "1430617124972679168", "1441319392164208643", "1441320268761210882", "1438884872018436096", "1441314330998284299", "807349412", "1099048676436201483", "1441315911193874438", "1441304410605248512", "1441310814263078936", "1441312390977515530", "3308476580", "1434408512872878088", "1441304388413235202", "1087964844559663106", "161506149", "1105413539362033664", "780781246418788353", "1441295638671474695", "394019788", "1441297483313811462", "2320141651", "1441233249779400704", "152886714", "1441289546390335491", "1285840416747618304", "969651220179836929", "1441288470203224068", "1094348355403018240", "1441285191398395910", "1441285925766529027", "1441284666913267718", "1441285175384555520", "1441283039196160005", "1441282863920418821", "1423040893913690112", "1441277421689262080", "1441272636051378176", "779295908450054144", "1441275249715122180", "718252442870292481", "1441277893355573251", "1441275342824480772", "1285017159588954112", "2378520719", "1435557694753083396", "1441272788619182086", "1441267309406875658", "1432182360502636545", "1441271925901185024", "1441271979739267078", "1051206630677893120", "3014932665", "1440610821755715587", "773913507536498688", "1441267680607019012", "1372881869210025992", "1441265884354338821", "1112604404", "1440842959780339716", "1380335883467956224", "1136428397700059137", "1341502813424238594", "1441260953618632704", "1441207786994487300", "1323411759538053120", "1441072588860661762", "1441259736171630602", "1249316431839313920", "1441259848088182789", "1441258549657563140", "15102551", "1269383001437278208", "403162634", "1214269352", "1441257202510036997", "752602016820580352", "1441254198432067591", "1454003659", "1413632077551996929", "1441257896738574338", "789899408418611200", "1441253664476131339", "1437827729274048516", "3190176644", "37341587", "3301768265", "1441252042396213252", "1441251381940084737", "1441250278817206272", "1441252455061229571", "190640980", "1441251561426931718", "1440726219708719109", "1441240624217292800", "4691514048", "1441248649585958913", "1441248666749001732", "1441248738391986183", "50852542", "1441248772353191936", "1441248052765880327", "1441247628667228169", "1441245679251181569", "1010557890292322304", "1440800967763525640", "1419113009650208768", "1260763608054669312", "1441242114063421445", "1441240511797334016", "1441239525934596100", "1441241728804012042", "1441242633846681609", "1441241759829299200", "1429874759769198595", "1235963841210486784", "1441240104106807301", "1441241411983065092", "1435705964230025220", "870926081615949824", "1440861611359563781", "864659406776086530", "1441237913316904961", "172852487", "1441236149805010954", "1441232131053608966", "1441237384331366409", "1441234027789258755", "3257738418", "1441235590310096899", "1441235220909285380", "1441234088346615808", "1614007718", "1362077241497116674", "1441234128385363970", "1441234332132073479", "1439083960621993988", "1440511918809108484", "1416559676003598337", "1356001062503804931", "1435969353837518853", "164329230", "1441230921982640134", "1441079343984386051", "1406450151410094081", "1441231417724203012", "1441103142087626759", "1440504413303427085", "1420189955427553281", "1441225087831588867", "1441228220091621377", "1441227975026901000", "1441222435815059460", "1441226238987685893", "1436495724527685632", "1441225636605952005", "1441048126484144133", "141775065", "1441225642297597954", "1440706605348098065", "1441225741404831757", "1441224414339555331", "1366858472399192066", "4471810955", "3246712038", "614886168", "1379070541039087617", "1441222685871128579", "1056710675840544768", "1441224436892373000", "1441224345334923267", "1441194299727638531", "1441223563122405384", "1441217301877981191", "1441223097604997131", "26712331", "1441217970890436616", "365311486", "1365731165856956418", "1383477811571159041", "1286134674721345536", "1441218297500823564", "1439764571972120576", "1441216777577398277", "907080234905636865", "1441215576240635912", "1359209597018472448", "1425546732344119302", "1024926382550396928", "1441215502383140867", "1441218372142714883", "1281335420295487488", "1336659341856870401", "1441085984519585795", "838030949787054085", "1430290575325122560", "1441215343603503109", "1703606923", "1441216711328342017", "1441213875966201857", "1428082149152919554", "1441195111606415361", "1439608585038741508", "1441086263289810947", "1441216626997673986", "4328170575", "1441214991776956418", "1087460265925447681", "1441215319620534278", "1441210904113123330", "1434712470413774852", "1439801976082993171", "1441212739532124172", "1441213566204317704", "1441210500625289220", "980255116472340480", "1441209637953363970", "1422316962554728457", "1441209654265073671", "1333643312293670912", "1441210502080712709", "1441210774735572996", "1441210811683262473", "1404111293594935298", "1441211506087972870", "1422619708377948173", "1441208981104443395", "1441209339016990722", "1439738579354271750", "1441180764536590337", "856442834", "1441207336245161991", "1441206960175472646", "1441208064296714242", "1441207656761364483", "1441207433158803466", "1390841501878390784", "1341866776209088513", "1441207938496958464", "1441207741465333768", "1440485539606523904", "952818134213414917", "1354625227536396290", "1441207277868908546", "297063134", "1147925812882137090", "62872525", "1441201768759582733", "1421099655774052353", "1441205957573242885", "36677427", "1441203582309601286", "1296085855170428929", "1438318069219168261", "1441204539353223172", "1441205408408825859", "1441201778482049032", "894389478", "2306310310", "1121585757725036544", "1441201383424749576", "1441203270542757893", "1441203117505220611", "257800069", "734034417128181760", "72856943", "1370906536667664385", "932345384881487873", "54943122", "1382917424", "1441200945040220164", "1432355952406245378", "1441201079765504007", "1441200861904998400", "587424997", "1441199380090941443", "1426252223437164549", "1407626270721073153", "61045337", "1441193475840503808", "1439286433638932482", "1383821327715295243", "1441198661145268229", "974761040469741568", "1439431061512105985", "974454417025126401", "1441045349393526789", "1277883870252163074", "806298983052279811", "1027551790131294208", "1441195260407808002", "1432078332909207552", "1441194600366891019", "716412008506257408", "1186440274580574208", "1441194026821042182", "1441191172827795465", "1441192199727685634", "1441191555340013585", "435405594", "1425107585557049347", "1441184172312186882", "1424770825027264513", "857795181323726848", "1441188123149418504", "620367430", "1441139240788627457", "1441181652999311366", "1425433257148129298", "1441187258992717827", "410515706", "51481277", "1441177589217824773", "1441186482153144325", "1243022541465124864", "1441185576699326466", "930413094", "1331368761715163136", "1441182623611572240", "1365009484402331657", "1441180532830703625", "1441182968479764480", "1441175254752120836", "1362227081208291328", "1232000058448465920", "1441176938362511362", "1441181859577098240", "1441180925690212355", "917233458988093440", "1439032077945499657", "1441178747382628359", "1411339869008367616", "1441178487608397827", "1440403455743447041", "943284486770274304", "1441124665485938691", "1441177992495915018", "1441075042398449666", "57644938", "1441175031371812865", "345541994", "962091677962956800", "1441175465796857863", "1431313310322810883", "1441174013615558658", "1441080853841465344", "1441170684462317571", "1402303445416226817", "1441171540867833871", "1365822805", "1439368698347786244", "1441172076161748993", "1441170013834997762", "1441155541145767940", "1441169033517142019", "1384090077928706050", "1441168119653810180", "271724240", "2748974541", "1441166462337441792", "1430051450", "1441134967090814983", "1441164720640172037", "191168583", "1217240822", "1216593841232449538", "1441166012519383040", "1087639309", "1441162101670625281", "33294614", "1441163492472414214", "1440888538841690112", "1441161019858898965", "826534230796693504", "1435249916268490764", "1441162794141847556", "1441161752117329920", "1431288102061068294", "1441160965366562820", "825791786152976384", "1439694372585590788", "1441084211285397505", "1438899432045662208", "1412383660855148549", "1441158821615837189", "1441158428823474177", "1441157962362277890", "937808571881967616", "1441156189161594885", "1441155628274122754", "1035247011757477888", "1441155779604611082", "1441061099919405056", "1441125517864865792", "1441153449672921094", "1439273103306133504", "1438328006548852743", "1295232678820683777", "9173082", "1237661976", "1441152110058360836", "1441146360779051013", "1441152941721718795", "1441153346933452809", "1701109350", "1441151400075874308", "1419622576326905857", "1441142029526835204", "1435067698065592326", "1441149450089472003", "1387904277616726019", "1441149086275543046", "1441150359183843329", "1429617928308248578", "1237473409354936320", "1441148799968169984", "1393338731810131968", "1441147200638046212", "1440919168073797636", "227093678", "1436018685479694338", "1411188351273562117", "1438449215311593477", "1441144606603636740", "1331049750465032193", "1420112232436969473", "1428533432854982659", "2423853273", "1441136913428013064", "1441142183780704260", "1438568049632858118", "1441141491854757891", "4686771120", "1436811530134241282", "229966837", "1441114430935236610", "1440508702000254980", "1422877287905742849", "1435601374453059589", "1441139585858224140", "188004799", "1221125166266118144", "1441138596866498560", "1378767483776081928", "1441139647673892878", "876078839008419840", "1252758311151325184", "1358468646247538688", "1437830127552016391", "1440327041606316044", "30053287", "1441138295958749194", "1432085820203159556", "1441136880561524736", "1341575132981112834", "1338361146194210818", "1440045752437264385", "290223710", "1441136057957838849", "926499398695055360", "410086284", "1441090826138914817", "1441133358981935106", "1441130126884806659", "1441133122943275013", "23976042", "1441134330885988354", "1441133172205436931", "1441130244467953670", "1441133085056069638", "133194183", "774288018031030272", "1441131988761518088", "1429838563017887746", "1441131002726739968", "1383668523801538562", "1438290310325579781", "1440042434600206336", "1441129106330902528", "1581548352", "26479441", "1439024844247638024", "1352091039713153024", "858135923724255235", "2366139006", "1441125069023944709", "590945455", "1243183764559343616", "890970809807851528", "777707869705691136", "161993766", "1441127354726633472", "1392947370632089609", "35687253", "536647683", "1539239917", "1438248390450626564", "1441125506980605952", "1440499119328432128", "1441123811038879748", "1434347569874935811", "1441119976610414594", "1441123579060318223", "1545616015", "1262083935871340547", "1422002364903534593", "1436814411319201800", "1428922262510620674", "1441122255870652416", "1441121596035325953", "1427691695722934279", "1280631847198883840", "139642857", "1437928066680979456", "2924592869", "1261384903343501317", "1441118952126443521", "1339124619136143360", "1441114810247041026", "1441115849457209351", "1354090929603239936", "1441042419995136004", "1440740585845911557", "1441116205075496964", "1441113393394376706", "1437190947255767041", "1006500180789743616", "1436428703190425611", "3079186222", "3295690158", "1441114060339089423", "1441114691183407104", "387238971", "1302951351140442112", "1441113249110388740", "1440840959504228357", "190073675", "1441111434398617605", "1394564652714102784", "1440646913951371283", "1441110548863614987", "1439706876208455680", "1441108315853885448", "1438613646318268416", "1425183063974289414", "1441109423997349891", "1387142775800426496", "1441109087429677059", "1436872392584962049", "1440886219773259776", "1441106136833265674", "171717277", "1441106461795307528", "875490188784357376", "1441104931738374151", "1440522657338822656", "1441105347159097344", "1441105153688436743", "1440761916549263367", "1441105136563077123", "1441104718797832193", "40806860", "1441097881373462530", "1441052332305887238", "1441097712099758084", "1381791335095672833", "746085506694397952", "1441101851928109069", "2908627362", "1441091581637849089", "1441097642361057290", "1441098436330201092", "1230914280695840769", "1436320947863236623", "1441098617553489921", "1441097945584058373", "1441098486624051209", "1441095887699148817", "1105580135716175872", "1441091952854724615", "53556225", "1132833625", "1441091338116558852", "1441093317215678464", "1441089927274393615", "1441094535690424326", "861755339632513024", "1441088814190006277", "1441092390979211273", "1243254626444611585", "810137601046966272", "1441091897288630273", "1225509470094139395", "1439476114930417666", "1441085438853148679", "1441088700251738123", "981168519051202560", "1429084577369370635", "1440440664555081731", "1318403810755252224", "1420881554142806025", "1345563273199054852", "1441085907570810881", "826229915112570880", "1237014708705611776", "1193331827391512576", "1441057463969669124", "3959345833", "1401369349139714050", "211363784", "461068018", "550980523", "1419119046881157127", "3228191580", "1438536550099398658", "1440753992766685197", "1411773103080804352", "1441080043208253446", "1441077952670748680", "1440012560904949760", "1441076578327400448", "1441078481513848835", "1441076457703448577", "1441077469482717185", "1312467433735753729", "1423805629353897985", "3353081163", "274915810", "1075061040747085824", "1345117455153291270", "1441053458627366925", "1436803807753564162", "1441072531855876097", "1441074554051379210", "1441075522490957833", "34407842", "1440055197502304267", "1441073001089351682", "1414569496111509512", "1436668912729477126", "1441070554635714561", "1406025370218942465", "1435939377142718464", "1441069650335436800", "1441069441601712129", "1433091642257330176", "1419519363997224963", "1431761729202135040", "843953732", "1402647627385217026", "1441066679363067910", "1441067024671653895", "2177203022", "1431202529895985155", "1440099072623329281", "1440706090342125580", "1439054416351481857", "1125056488253415424", "1441067075561136129", "1367002003", "265791759", "1441008813914697729", "825030296844185600", "1441065085389082627", "1423700983260057600", "1441064624238043137", "1441061663181004805", "1441063430824153099", "1441064427516661769", "1382133265482518531", "1201248710283407361", "1441057802336751617", "1441063569299148804", "1431277533320949762", "1441062144645214213", "35658749", "1413540928606851077", "1099731278805590017", "1441062558664777736", "1441058778347020291", "187999048", "1431064115393355781", "1441061503763898370", "1441060597861335043", "1441060881908092929", "1437838340477358081", "1441053833904328712", "1123799037331816449", "1441058538470744065", "1196898933517234176", "1441052737362354176", "1441054049269387264", "1441056286632677377", "51845459", "1441057288098299906", "1441053674118291457", "1410274731681587205", "1399859920972009478", "1420680369217708033", "1440356845617496066", "1441052939733422080", "1441054306304761857", "1441054439733932037", "1286248797685682176", "826975407727636484", "1441046565418897408", "1441055379723624448", "1386299377140994060", "216923635", "3413451969", "708676908595056640", "1441052483476987906", "1441049119586279431", "942722198380433408", "1441050530998931460", "1441051302117715977", "1441050282188673031", "918308826134151174", "2706544829", "1441047219872796678", "1441046844214292482", "505847544", "1441048924836352011", "75703528", "1441046233108422658", "1379635614325280770", "1441046773892538373", "1441047340396208128", "251227666", "1441047128860606473", "1379897677303971854", "1441042963707084804", "1161793176098758661", "1428171362401755138", "1432390229424590850", "24264617", "1441043880267313155", "1284908549752205312", "1361970671342018561", "1440744736797577222", "1441043372458663940", "1382407565850648578", "1239967816155086848", "716934808", "1441041836764643334", "1044506117655662593", "1396294524352278530", "1441038797546872844", "1434601873621848072", "37529641", "408918169", "1417262274297860098", "259827018", "1441038107017682945", "1441038391861125127", "1441037191585562629", "1265349781158793216", "1441037934963019789", "1439939355313942531", "107895402", "1433106952104644608", "1440987991401500674", "1248205463587438592", "1398090690555527168", "44486379", "1228344470464131072", "1437830665219706884", "1441032771137384448", "1348477914292117506", "1365953478", "1319453258558132224", "1317135152192028678", "1411799933548695565", "1441033179444531203", "432723517", "555421524", "515819938", "1441031546731962372", "1441028823668117507", "1242084331", "1358450265666551814", "1440317623464456210", "1441028993487147009", "1441028754806087682", "1358572101515501573"};

				for(String tmp:smth) {
					follower.add(tmp);
				}
				System.out.println(follower);
				
				//★
				String[] smth2 = new String[] {"31126587", "36155311"};
				for(String tmp:smth2) {
					followee.add(tmp);
				}
				System.out.println(followee);
				
				List<String> temp1 = new ArrayList<>(follower);
				//multiuser 하기 전에 csv_id를 t_id로 바꿔줘야 함.
				//List<String> temp1 = (follower != null && follower.size()>0)?new ArrayList<String>(Arrays.asList(TwitterLookup.multiUsers(Check.checkCSV(((List<String>)follower).toArray(new String[0]))))):null;
				//List<String> temp1 = (follower != null && follower.size()>0)?new ArrayList<String>(Arrays.asList(TwitterLookup.multiUsers(Check.checkCSV(((List<String>)follower).toArray(new String[0]))))):null;
				System.out.println("Twitter multiusers for follower lookup proceeded.\n"+((temp1==null || temp1.size()==0)?0:temp1.size())+" users exist out of "+follower.size());
				
				if(temp1!=null && temp1.size()>0) {
					removeNull(temp1);
					System.out.println(temp1);
					
					for(String p:temp1) {
						//if(greeter.getNodes().length>max) break;
						//String csv_id = Check.checkCSV(p, 1);
						//greeter.insertNode(csv_id, p);
						greeter.insertNode(String.valueOf(tmp_id), p);
						//if(!start.equals(p)) greeter.createRel(start, p);
						//greeter.createRel(start, csv_id);
						greeter.createRel(orgie, String.valueOf(tmp_id));
						tmp_id++;
					}
				}
				
				List<String> temp2 = new ArrayList<>(followee);
				//List<String> temp2 = (followee != null && followee.size()>0)?new ArrayList<String>(Arrays.asList(TwitterLookup.multiUsers(Check.checkCSV(((List<String>)followee).toArray(new String[0]))))):null;
				//String[] temp2 = (followee.size()>0)?TwitterLookup.multiUsers(Check.checkCSV(((List<String>)followee).toArray(new String[0]))):null;
				System.out.println("Twitter multiusers for followee lookup proceeding.\n"+((temp2==null || temp2.size()==0)?0:temp2.size())+" users exist out of "+followee.size());
				
				if(temp2!=null && temp2.size()>0) {
					removeNull(temp2);
					System.out.println(temp2);
					
					for(String p:temp2) {//이 시점에서 temp는 t_id로 구성됨.
						//if(greeter.getNodes().length>max) break;
						//String csv_id = Check.checkCSV(p, 1);
						//greeter.insertNode(csv_id, p);
						greeter.insertNode(String.valueOf(tmp_id), p);
						//if(!start.equals(p)) greeter.createRel(p, start);
						//greeter.createRel(csv_id, start);
						greeter.createRel(String.valueOf(tmp_id), orgie);
						tmp_id++;
					}System.out.println("Finished for loop in line 109");
				}
				System.exit(0);
				
				boolean sw = true;double rand = new Random().nextDouble();
				
				//followee부터 봐야 빠를 수 밖에 없는 게 follower 보다 followee가 영향력 있는 사람일 가능성이 큼.
				if(!followee.isEmpty() && sw) {
					int idx = getFollCount(temp2, (int)(followee.size()*rand));
					if(idx != -1) {
						sw = false;
						start = temp2.get(idx);
					}
				}
				
				if(!follower.isEmpty() && sw) {
					int idx = getFollCount(temp1, (int)(follower.size()*rand));
					if(idx != -1) {
						sw = false;
						start = temp1.get(idx);
					}
				}
				
				if(sw) {
					System.out.print("Both queues are empty, therefore we choose a node by random.: ");
					start = String.valueOf((int)(Math.random()*41000000));
					System.out.println(start+" has been selected.");
				}
				
				follower.clear();followee.clear();
				
				//System.out.println("Starting the loop at line 46 at "+LocalDateTime.now().plusMinutes(16));
				//TimeUnit.MINUTES.sleep(16);
				
				fr.getChannel().position(0);br = new BufferedReader(new InputStreamReader(fr));
			}
			
			System.exit(0);
			*/
			System.out.println("Collecting "
					+ "db's nodes to make all relationships reflected in graph.");
			
			int[] nodes = greeter.getNodesB();
			System.exit(0);
	    	c = 0;
	    	System.out.println(nodes[0]);
	    	System.exit(0);
	    	quickSort(nodes, 0, nodes.length-1);
	    	
			fr.getChannel().position(0);
	    	br = new BufferedReader(new InputStreamReader(fr));
	    	
	    	System.out.println("Entered {while loop} at line 161");
	    	
	    	long time = System.currentTimeMillis();
	    	int fur = 0;
	    	
			while((t=br.readLine())!=null)	{
				ids = t.split(" ");
				
				if((++c)%10000==0) {
					System.out.println("Final {while loop} count: "+c);
					long curr = System.currentTimeMillis();
					System.out.println(curr - time+"ms");
					time = curr;
				}
				
				if(Arrays.binarySearch(nodes, Integer.parseInt(ids[0]))>=0 && Arrays.binarySearch(nodes, Integer.parseInt(ids[1]))>=0) {
					greeter.createRel(ids[0], ids[1]);
					if(++fur%100000 == 0) System.out.println("FOUND:" + fur);
				}
			}
		}
		br.close();
    }
}